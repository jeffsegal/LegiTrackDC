{"version":3,"sources":["legislationList.controller.js"],"names":[],"mappings":"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","file":"legislationList.controller-compiled.js","sourcesContent":["'use strict';\nvar app = angular.module('legitrackApp');\n\nvar ROW_LIMIT_DEFAULT = 5;\n\nfunction LegislationListCtrl($scope, $http, $resource, limsService) {\n  var me = this;\n  this.$scope = $scope;\n  this.$http = $http;\n  this.$resource = $resource;\n\n  me.$scope.query = {\n    limsBase: 'http://lims.dccouncil.us/api/v1/Legislation',\n    CategoryId: 0,\n    rowLimit: ROW_LIMIT_DEFAULT,\n    offset: 0\n  };\n\n  //console.log(limsService.masters.stuff[1]);\n  me.resetResults();\n  me.$scope.searching = false;\n  me.populateLocalMasters();\n\n  $scope.searchLegislation = function (query, isNew) {\n    me.searchLegislation(query, isNew);\n  };\n  $scope.nextPageDisabledClass = function () {\n    return me.nextPageDisabledClass();\n  };\n  $scope.getStatusClass = function (legislation) {\n    return me.getStatusClass(legislation);\n  };\n  $scope.loadMore = function () {\n    me.loadMore();\n  };\n}\n\n/**\n * Public Methods\n */\n\nLegislationListCtrl.prototype.searchLegislation = function (query, isNew) {\n  var me = this;\n  if (isNew) {\n    me.resetPagination();\n    me.resetResults();\n  }\n  var url = query.limsBase + '/Search/' + query.rowLimit + '/' + query.offset;\n  console.log(\"Issuing query to \" + url);\n  me.$scope.searching = true;\n  me.$http.post(url, {\n      Keyword: query.text,\n      CategoryId: query.CategoryId\n    })\n    .then(function (response) {\n        //console.log('response: ' + JSON.stringify(response));\n        me.$scope.response = response;\n        me.$scope.results = me.$scope.results.concat(response.data);\n      }, (function (error) {\n        console.log('Error: ' + error);\n        me.$scope.response = error;\n      }))\n    .finally(function (response) {\n      me.$scope.searching = false;\n      console.log('done');\n    }\n  );\n};\n\nLegislationListCtrl.prototype.nextPageDisabledClass = function () {\n  var me = this;\n  return me.$scope.response && me.$scope.response.data.length >= ROW_LIMIT_DEFAULT ? \"\" : \"disabled\";\n  //return \"disabled\";\n};\n\nLegislationListCtrl.prototype.getStatusClass = function (legislation) {\n  switch (legislation.LegislationStatus) {\n    case \"New\": return \"glyphicon glyphicon-star-empty\"; break;\n    case \"Deemed Approved\": return \"glyphicon glyphicon-ok\"; break;\n    case \"Under Council Review\": return \"glyphicon glyphicon-hourglass\"; break;\n    case \"Withdrawn\": return \"glyphicon glyphicon-remove\"; break;\n    default: return \"glyphicon glyphicon-flag\";\n  }\n};\n\nLegislationListCtrl.prototype.loadMore = function () {\n  //TODO: fix resetting of text query\n  var me = this;\n  me.$scope.query.offset++;\n  me.searchLegislation(me.$scope.query, false);\n};\n\n/**\n * Private Methods\n */\n\nLegislationListCtrl.prototype.resetPagination = function () {\n  var me = this;\n  me.$scope.query.rowLimit = ROW_LIMIT_DEFAULT;\n  me.$scope.query.offset = 0;\n};\n\nLegislationListCtrl.prototype.resetResults = function () {\n  var me = this;\n  me.$scope.results = [];\n  me.$scope.response = null;\n};\n\nLegislationListCtrl.prototype.populateLocalMasters = function () {\n  var me = this;\n  var Masters = $resource('/api/masters/:name', { name: '@name' });\n  var user = Masters.get({}, function(response) {\n    var json = JSON.parse(response);\n    console.log(json);\n    me.$scope.masters = json;\n  });\n};\n\napp.controller('LegislationListCtrl', LegislationListCtrl);\n"]}